<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width initial-scale=1" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<title>UI组件的模板常量 | Magento 2 Developer Documentation</title>
	<meta name="description" content="Magento 2 Developer Documentation.
">

	<link rel="stylesheet" href="/assets/css/app.css" />
	<link rel="stylesheet" href="/assets/css/print.css" media="print"/>

	<link rel="stylesheet" href="/common/css/devdocs.css" />

	<script>
  var baseUrl = "";
  var algolia = {
    id : "E642SEDTHL",
    index:  "devdocs",
    key:  "d2d0f33ab73e291ef8d88d8b565e754c"
  };
</script>




	<link rel="canonical" href="http://localhost:4000/guides/v2.1/ui_comp_guide/concepts/ui_comp_template_literals.html">

	<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="https://magento.com/favicon.ico">
	<link rel="apple-touch-icon" type="image/png" href="https://magento.com/apple-touch-icon.png">
	<link rel="apple-touch-icon" type="image/png" sizes="57x57" href="https://magento.com/apple-touch-icon-57x57.png">
	<link rel="apple-touch-icon" type="image/png" sizes="72x72" href="https://magento.com/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://magento.com/apple-touch-icon-76x76.png">
	<link rel="apple-touch-icon" type="image/png" sizes="114x114" href="https://magento.com/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://magento.com/apple-touch-icon-120x120.png">
	<link rel="apple-touch-icon" type="image/png" sizes="144x144" href="https://magento.com/apple-touch-icon-144x144.png">
	<link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://magento.com/apple-touch-icon-152x152.png">
	<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://magento.com/apple-touch-icon-180x180.png">

</head>
<body class="layout-default">

	<header class="site-header">

		<nav class="site-nav">

  <div class="menu-btn">
    <a id="menu-btn" class="menu-trigger menu-icon" href="#nav-main" aria-haspopup="true" aria-controls="nav-main"></a>
  </div>

  <div class="nav-container">

    <a class="logo" href="/guides/v2.1/">
      <img src="/assets/i/m-logo.svg" alt=""><img src="/assets/i/magento-logo.svg" alt="Magento" class="magento-logo" />
      <span class="site-logo">DevDocs</span>
    </a>

    <div id="nav-main" class="nav-main-wrap" aria-labelledby="menu-btn">
      
<div class="version-switcher dropdown" data-version="2.1">
	<button id="version-switcher-button" class="btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Magento 2.1
	</button>

	<ul class="dropdown-menu dropdown-menu-left" aria-labelledby="version-switcher-button">
	
		<li><a class="dropdown-item" data-proofer-ignore href="/guides/v2.0/ui_comp_guide/concepts/ui_comp_template_literals.html">Magento 2.0</a></li>
	
		<li><a class="dropdown-item" data-proofer-ignore href="/guides/v2.1/ui_comp_guide/concepts/ui_comp_template_literals.html">Magento 2.1</a></li>
	
		<li><a class="dropdown-item" data-proofer-ignore href="/guides/v2.2/ui_comp_guide/concepts/ui_comp_template_literals.html">Magento 2.2</a></li>
	
		<li><a class="dropdown-item" data-proofer-ignore href="/guides/v2.3/ui_comp_guide/concepts/ui_comp_template_literals.html">Magento 2.3 Pre-release</a></li>
	
  </ul>

</div>


      <!-- Main Navigation -->
<ul class="nav-main" role="menubar">

  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">部署</span>

    <div class="nav-popup" role="menu" aria-hidden="true">
      <ul>
          <li><a href="/guides/v2.1/install-gde/bk-install-guide.html">安装向导</a></li>
          
          <li><a href="/guides/v2.1/comp-mgr/bk-compman-upgrade-guide.html">组件管理和系统升级手册</a></li>
          
          <li><a href="/guides/v2.1/config-guide/bk-config-guide.html">配置手册</a></li>
          
          <li><a href="/guides/v2.1/migration/bk-migration-guide.html">迁移指引</a></li>
          <li><a href="/guides/v2.1/cloud/bk-cloud.html">上云指引</a></li>
          <li><a href="/magento-release-information.html">版本日志</a></li>
      </ul>
    </div>

  </li>


  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">开发</span>

    <div class="nav-popup" role="menu" aria-hidden="true">

      <div class="nav-section">
        <div class="nav-section-title">服务端</div>
        <ul>
          <li><a href="/guides/v2.1/architecture/bk-architecture.html">架构说明</a></li>
          <li><a href="/guides/v2.1/extension-dev-guide/bk-extension-dev-guide.html">PHP开发文档</a></li>
          <li><a href="/guides/v2.1/ext-best-practices/bk-ext-best-practices.html">扩展开发实践</a></li>
          <li><a href="/guides/v2.1/mrg/intro.html">各模块介绍</a></li>
          <li><a href="/guides/v2.1/coding-standards/bk-coding-standards.html">编码规范</a></li>
          <li><a href="/guides/v2.1/contributor-guide/contributing.html">贡献指引</a></li>
        </ul>
      </div>

      <div class="nav-section">
        <div class="nav-section-title">前端</div>
        <ul>
          <li class=""><a href="/guides/v2.1/frontend-dev-guide/bk-frontend-dev-guide.html">前端工程师手册</a></li>
          
          <li><a href="/guides/v2.1/ui_comp_guide/bk-ui_comps.html">UI组件手册</a></li>
          
          <li><a href="/guides/v2.1/javascript-dev-guide/bk-javascript-dev-guide.html">JavaScript开发手册</a></li>
          <li><a href="/guides/v2.1/pattern-library/bk-pattern.html">管理面板设计模式及所用库</a></li>
          <li><a href="/guides/v2.1/design-styleguide/bk-styleguide.html">管理面板样式手册</a></li>
          <li><a href="https://magento-research.github.io/pwa-devdocs/">PWA Studios</a></li>
        </ul>
      </div>

      <div class="nav-section">
        <div class="nav-section-title"><abbr>API</abbr></div>
        <ul>
          <li><a href="/guides/v2.1/get-started/bk-get-started-api.html">Web APIs起步</a></li>
          <li><a href="/guides/v2.1/rest/bk-rest.html">REST API参考</a></li>
          <li><a href="/guides/v2.1/soap/bk-soap.html">SOAP API参考</a></li>
          
          
          <li><a href="/guides/v2.1/marketplace/eqp/api.html">Marketplace EQP API Reference</a></li>
          
        </ul>
      </div>
    </div>

  </li>


  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">测试</span>

    <div class="nav-popup" role="menu" aria-hidden="true">
      <ul>
        <li><a href="/guides/v2.1/test/testing.html">Magento测试手册</a></li>
        
        <li><a href="/guides/v2.1/mtf/mtf_introduction.html">功能测试</a></li>
        <li><a href="/guides/v2.1/test/integration/integration_test_execution.html">集成测试</a></li>
        <li><a href="/guides/v2.1/test/js/jasmine.html">JavaScript单元测试</a></li>
        <li><a href="/guides/v2.1/test/unit/unit_test_execution.html">PHP单元测试</a></li>
        <li><a href="/guides/v2.1/get-started/web-api-functional-testing.html">Web API功能测试</a></li>
      </ul>
    </div>

  </li>


  <li class="nav-main-separator"></li>


  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">功能文档</span>

    <div class="nav-popup" role="menu" aria-hidden="true">
      <ul>
          
        
        <li><a href="/guides/v2.1/howdoi/checkout/checkout_overview.html">Checkout</a></li>
        <li><a href="/guides/v2.1/payments-integrations/bk-payments-integrations.html">支付集成</a></li>
        
          <li><a href="/guides/v2.1/extension-dev-guide/staging.html">Staging</a></li>
        
      </ul>
    </div>

  </li>


  <li class="nav-main-item"  tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">指引</span>

    <div class="nav-popup" role="menu" aria-hidden="true">
      <ul>
        <li><a href="/guides/v2.1/howdoi/bk-how-do-i.html">如何</a></li>
        
        <li><a  data-proofer-ignore href="/guides/v2.1/get-started/order-tutorial/order-intro.html">使用EST APIs处理订单</a></li>
        

        <li><a href="/videos/">视频教程</a></li>
      </ul>
    </div>

  </li>

</ul><!-- /.nav-main -->

    </div>

    <div class="search-btn">
      <a class="search-trigger search-icon" href="#"></a>
    </div>

    <form class="quick-search" action="/guides/v2.1/search.html" method="get" novalidate="novalidate">
      <input type="search" name="q" placeholder="Search" />
      <a href="#" class="quick-search-close">&times;</a>
    </form>

  </div>

</nav><!-- #site-nav -->
<div class="nav-main-fader"></div>


	</header>

	<div class="global-wrapper">

		<div class="main-container">
			<a id="main-content"></a>


<div class="content-container">

	<!-- sidebar -->
<aside class="sidebar">
	<a href="#" data-proofer-ignore class="toc-toggler">内容表格</a>
	<div class="sidebar-wrapper">

		

		<h4 class="guide-title"></h4>
		<div class="collapsible-navigation">
		    <ul>
		    
		    </ul>
		</div>

	</div>

</aside>
<!-- /sidebar -->


	<section class="content">
		<div class="content-wrap">
			<!-- page-header -->
<section class="page-intro">
	

  <nav class="breadcrumbs">

    <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      <li class="breadcrumb-item"><a class="breadcrumb-item" href="/guides/v2.1/"><span>首页</span></a></li>

    <!-- Iteration breadcrumb item -->
    
    

    

      <!-- Skip if root -->
      

      <!-- Get breadcrumb title -->
      

      <!-- SEO data -->
      

      <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">

        
          <a property="item" typeof="WebPage" href="/guides/v2.1/ui_comp_guide/bk-ui_comps.html">
            <span property="name">UI组件概述</span>
          </a>
        

        <meta property="position" content="1" />
      </li>

    

      <!-- Skip if root -->
      

      <!-- Get breadcrumb title -->
      

      <!-- SEO data -->
      

      <li class="breadcrumb-item active" property="itemListElement" typeof="ListItem">

        

          

          <span property="name">UI组件的模板常量</span>

        

        <meta property="position" content="2" />
      </li>

    

    </ol>

  </nav>



	

	

	<h1 class="page-heading">UI组件的模板常量</h1>

  


</section>

			<h1 id="模板常量-in-magento">模板常量 in Magento</h1>

<p>Magento provides for the use of template literals in UI 组件. Template literals are strings that can contain embedded expressions. They were introduced into Javascript with ES2015 and were called “template strings” in early editions of the ES2015 / ES6 specification. Since it is a relatively new part of Javascript, some browsers, such as IE11, do not support the specification. Per the specification standard, back-ticks (<code class="highlighter-rouge">`</code>) are used instead of a single quote (<code class="highlighter-rouge">'</code>) or double quote (<code class="highlighter-rouge">"</code>) to delineate a template string. Due to the lack of browser support, Magento has a Javascript class that will parse certain strings with a single quote (<code class="highlighter-rouge">'</code>) in the same way a browser that supports the specification would parse one with back-ticks.</p>

<p>Template literals can contain expressions which will be evaluated in the current KnockoutJS context. These expressions can contain nearly any valid <span term-uuid="312b4baf-15f7-4968-944e-c814d53de218" class="glossary-term" data-toggle="popover">Javascript</span>. They must start with a dollar sign and be surrounded with curly braces. <strong>Anything inside the following will be evaluated as an expression</strong>: <code class="highlighter-rouge">${  }</code>. For example, they can be used—and often are—to access properties of the KnockoutJS context like this: <code class="highlighter-rouge">'${ $.submitUrl }'</code>. They can be used to call functions (<code class="highlighter-rouge">'${ $.loadForm($.formUrl) }'</code>), or whatever: <code class="highlighter-rouge">'${ 20 + 13 }'</code>. These expressions are parsed in <code class="highlighter-rouge">/lib/web/mage/utils/template.js</code>.</p>

<p>Template literals allow UI 组件 to easily assign dynamic values to class properties. More specifically, they provide an integration layer between a particular KnockoutJS context and a Javascript class.</p>

<h3 id="the-defaults-class-property">The <code class="highlighter-rouge">defaults</code> Class Property</h3>

<p>UI components are <a href="http://devdocs.magento.com/guides/v2.1/ui_comp_guide/concepts/ui_comp_uiclass_concept.html">associated with Javascript classes</a> to handle behavior on the client side. These should extend one of the core classes to provide a base level of functionality. Inside the child class, a <code class="highlighter-rouge">defaults</code> property can be provided.</p>

<p>The <code class="highlighter-rouge">defaults</code> property should be an object and is handled in a special way. Each property of <code class="highlighter-rouge">defaults</code> becomes a class property upon initialization. This happens in the <code class="highlighter-rouge">initConfig()</code> method of <code class="highlighter-rouge">lib/core/class.js</code>. Every item in <code class="highlighter-rouge">defaults</code> is passed through a <code class="highlighter-rouge">template()</code> function which evaluates template literals.</p>

<p>As a result, every <code class="highlighter-rouge">defaults</code> child property is handled with what could be viewed as a two step process:</p>

<ol>
  <li>Evaluate the value of the property for expressions. 例如: <code class="highlighter-rouge">'${ $.submitUrl }'</code> could become <code class="highlighter-rouge">'https://example.com/contact/form/submit/'</code> (more on that later).</li>
  <li>Assign that property/value to the class itself. As a result <code class="highlighter-rouge">class.defaults.submitUrl</code> would become <code class="highlighter-rouge">class.submitUrl</code>.</li>
</ol>

<p>This part is important because it means that Javascript classes that extend <code class="highlighter-rouge">Class</code> (<code class="highlighter-rouge">magento/module-ui/view/base/web/js/lib/core/class.js</code>) can use the <code class="highlighter-rouge">defaults</code> property to assign properties to the class itself and leverage template literals during that process without any work on your part.</p>

<h4 id="the--separator">The <code class="highlighter-rouge">:</code> separator</h4>

<p>Certain properties of the <code class="highlighter-rouge">defaults</code> object are processed by an additional core Javascript class: <code class="highlighter-rouge">links.js</code> (located: <code class="highlighter-rouge">magento/module-ui/view/base/web/js/lib/core/element/links.js</code>). The object keys in <code class="highlighter-rouge">defaults</code> are:</p>

<ul>
  <li><code class="highlighter-rouge">links</code></li>
  <li><code class="highlighter-rouge">imports</code></li>
  <li><code class="highlighter-rouge">exports</code></li>
</ul>

<p>They can be used to interact with other UI Component Javascript classes. While the full use of them is a separate topic, those values can use a colon (<code class="highlighter-rouge">:</code>) to separate an expression, which should evaluate to a UI Component’s name, from the properties to be accessed in that class. Take this example: <code class="highlighter-rouge">'${ $.provider }:user.theme'</code>. If the <code class="highlighter-rouge">${ $.provider }</code> expression evaluates to the name of a UI Component that is currently in the registry, that component will be loaded and the value of its <code class="highlighter-rouge">user.theme</code> property returned.</p>

<p>As a result, a template literal used in the value of one the objects listed above can be used to succinctly access data from an <em>entirely different</em> <span term-uuid="9bcc648c-bd08-4feb-906d-1e24c4f2f422" class="glossary-term" data-toggle="popover">UI Component</span> Javascript class.</p>

<h3 id="template-literal--context">Template Literal <code class="highlighter-rouge">$</code> context</h3>

<p>Perhaps the most important part of template literals in Magento is the <code class="highlighter-rouge">$</code> object that can be used inside expressions. (Remember an expression is anything within <code class="highlighter-rouge">${ }</code>.) The <code class="highlighter-rouge">$</code> provides access to the <code class="highlighter-rouge">this</code> context in the Javascript class where the template literals are. To take it a step further, <code class="highlighter-rouge">this</code> (and the related <code class="highlighter-rouge">$</code>) is the KnockoutJS context for the template that can be bound to the UI Component. This object should not be confused with the <code class="highlighter-rouge">$</code> that marks the beginning of an expression. The <code class="highlighter-rouge">$</code> object can only appear inside of an expression. Here is an example: <code class="highlighter-rouge">${ $.submitUrl }</code>: the <code class="highlighter-rouge">$</code> references the current KnockoutJS context, and <code class="highlighter-rouge">.submitUrl</code> will return the <code class="highlighter-rouge">provider</code> property from that object.</p>

<h2 id="例如">例如</h2>

<p>Perhaps the most useful aspect of template literals is the ability to access other UI Component Javascript classes in the registry so we will use this as an example. First, there are a few things to explain.</p>

<p>UI components can have a <code class="highlighter-rouge">&lt;item name="config" xsi:type="array"&gt;...&lt;/item&gt;</code> node in the primary XML declaration file (<a href="http://devdocs.magento.com/guides/v2.1/ui_comp_guide/concepts/ui_comp_xmldeclaration_concept.html#example-of-a-top-level-configuration-file">see an example</a>). In that file, a <code class="highlighter-rouge">component</code> element can be added with a path reference to the RequireJS file. That file is loaded into the registry when it runs on the front end and other Javascript files can then access it by the <em>name</em> of the UI Component instead of the path to the file itself. The name often will look something like this: <code class="highlighter-rouge">example_component.example_component</code>.</p>

<p>Names of other registered modules can be added to the <span term-uuid="ebe2cd14-d6d4-4d75-b3d7-a4f2384e5af9" class="glossary-term" data-toggle="popover">server side</span> configuration (XML or PHP) that is output through JSON. Those names can then be easily accessed in the Javascript on the front end. In the following example, the other UI Component’s name will be obtained with a template literal in the <code class="highlighter-rouge">imports</code> object. When this Javascript file is loaded, it will process the template literal and look up the name in the registry. If found, it will load that class. Because there is a colon (<code class="highlighter-rouge">:</code>), it will go on to find the property that is accessed in the other Javascript class.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="na">defaults</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">template</span><span class="p">:</span> <span class="s1">'Example_Component/message-list'</span><span class="p">,</span>
        <span class="na">imports</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">messages</span><span class="p">:</span> <span class="s1">'${ $.messageHandler }:data.userMessages'</span>
        <span class="p">}</span>
    <span class="p">},</span>

    <span class="c1">// ...</span>

    <span class="na">initialize</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">addHtmlClassesToMessages</span><span class="p">();</span>
    <span class="p">},</span>

    <span class="na">addHtmlClassesToMessages</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">messages</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">currentValue</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">currentValue</span><span class="p">[</span><span class="s1">'htmlClass'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'message message--'</span> <span class="o">+</span> <span class="nx">currentValue</span><span class="p">[</span><span class="s1">'type'</span><span class="p">];</span>
        <span class="p">});</span>
    <span class="p">}</span>

    <span class="c1">// ...</span>
<span class="p">})</span>
</code></pre></div></div>

<p>Notice how the <code class="highlighter-rouge">addHtmlClassesToMessages()</code> method accesses the <code class="highlighter-rouge">messages</code> property of <code class="highlighter-rouge">this</code>. When the class was initialized, the <code class="highlighter-rouge">data.userMessages</code> array was obtained from the <code class="highlighter-rouge">$.messageHandler</code> UI Component and was then assigned to the primary object.</p>

<p>In the template, the messages can be displayed like this:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- File: app/code/Example/Component/view/frontend/web/template/message-list.html --&gt;</span>
<span class="nt">&lt;div&gt;</span>
  <span class="nt">&lt;ul</span> <span class="na">data-bind=</span><span class="s">"foreach: messages"</span> <span class="na">class=</span><span class="s">"message-list"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;li</span> <span class="na">data-bind=</span><span class="s">"text: content, css: htmlClass"</span><span class="nt">&gt;&lt;/li&gt;</span>
  <span class="nt">&lt;/ul&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<h3 id="conclusion">Conclusion</h3>

<p>Template literals provide a simple and concise way to evaluate expressions. In Magento, they facilitate a great way to load data into a Javascript class. They also play a part in interacting with other classes to create a fully interactive front end framework.</p>

			
		</div>
		<!-- /.content-wrap -->

		<div class="page-info">

    
      <div class="page-contributor">
        <a href="https://swiftotter.com/" target="_blank">
          感谢SwiftOtter Studios贡献这篇文章
        </a>
      </div>
    
  
    
    <div class="github-link">
      <a class="improve-page" href="https://github.com/magento/devdocs/blob/develop/guides/v2.1/ui_comp_guide/concepts/ui_comp_template_literals.md" target="_blank">
        去GitHub上编辑
      </a>
    </div>
    
  
    
    <div class="new-issue">
      <a href="https://github.com/magento/devdocs/issues/new?title=Feedback on page: /guides/v2.1/ui_comp_guide/concepts/ui_comp_template_literals.html" target="_blank">反馈</a>
    </div>
    
  
  </div>

	</section>
	<!-- /.content -->

</div> <!-- /.content-container -->


	</div>
	<!-- /.main-container -->
</div>
<!-- /#gl-wrapper -->

<!-- footer-->
<div class="page-footer">
  <div class="container">

    <div class="copyright-links">
      <ul class="nav footer-links">
  <li><a href="/guides/v2.1/contributor-guide/contributing_docs.html">成为贡献者</a>
  <li><a href="https://magento.github.io/glossary/index.html?audience=developer">术语表</a></li>
  <li><a href="http://magento.com/legal/terms/privacy/">隐私政策</a></li>
  <li><a href="http://magento.com/legal/terms/">服务条款</a></li>
  <li><a href="http://magento.com/legal/licensing/">许可/商标 常见问题</a></li>
  <li><a href="/guides/v2.1/release-notes/bk-release-notes.html">版本日志</a></li>
  <li><a href="/magento-third-party.html">三方许可</a></li>
</ul>

    </div>

		<div class="copyright-date">&copy; 2018 Magento. All rights reserved.</div>

  </div>
</div>
<!-- / #footer -->


<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="/assets/js/app.min.js"></script>


<script src="/common/js/devdocs.min.js"></script>




</body>
</html>

